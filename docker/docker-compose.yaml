services:
  fastapi:
    container_name: detectai_fastapi
    depends_on:
      - postgres
    image: detectai_fastapi_image:latest
    ports:
      - 8302:8302
    volumes:
      - shared_env:/app/env
  vite:
    container_name: detectai_vite
    depends_on:
      - fastapi
    image: detectai_vite_image:latest
    env_file:
      - ../.env
    ports:
      - 8305:8305
    volumes:
      - shared_env:/app/env
  postgres:
    container_name: detectai_postgres
    image: postgres:latest
    ports:
      - 5433:5433
    volumes:
      - ./pgdata:/var/lib/postgresql/data
    environment:
      - PGPORT=5433
      - POSTGRES_DB=detectai
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres

volumes:
  shared_env:
  pgdata:
